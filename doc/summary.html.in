<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN">
<!-- $OpenBSD$ -->
<html>
<head>
<title>
SnertSoft - @PACKAGE_NAME@/@PACKAGE_VERSION@
</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="keywords" content="SMTP Filter Proxy, call back, call ahead, grey listing, greylisting, RET, Return Encrypted Tag" />
<meta name="description" content="@PACKAGE_NAME@ sits in front of one or more mail transfer agents (MTA) on SMTP port 25. It acts as a proxy, filtering and forwarding mail to one or more MTAs, which can be on the same machine or different machines." />
<link rel="stylesheet" type="text/css" href="./style.css" />
<script language="JavaScript" type="text/javascript" src="./mailto.js"></script>
</head>

<body>
<div align="center">
<table class="page" cellpadding="0" cellspacing="0" border="0">
<tr><td>

<a href="http://www.snertsoft.com/">
<img alt="SnertSoft: We Serve Your Server" src="Img/logo-300x74.png" width="300" height="74" border="0" /></a>

<div align="center">
<h1 class="title">Barricade MX</h1>
<h2>
@PACKAGE_NAME@/@PACKAGE_VERSION@
<br/><span class="large">&laquo;An SMTP Filtering Proxy&raquo;</span>
</h2>
</div>

<div class="contents">
<ol type="A" class="toc">
<li><a href="manual.shtml">Introduction</a></li>
<li><a href="license.html">License &amp; Support</a></li>
<li><a href="install.html">Installation</a></li>
<li>Configuration</li>
	<ol type="a">
	<li><a href="route-map.html">The Route Map</a></li>
		<ul>
		<li><a href="route-map.html#route_local_mta">Local MTA</a></li>
		<li><a href="route-map.html#route_local_route_queue">Local Route</a></li>
		<li><a href="route-map.html#route_relay">FORWARD &amp; RELAY</a></li>
			<ul>
			<li><a href="route-map.html#route_by_domain">by domain</a></li>
			<li><a href="route-map.html#route_by_mail_address">by mail</a></li>
			</ul>
		<li><a href="route-map.html#route_call_ahead">Call-Ahead</a></li>
			<ul>
			<li><a href="route-map.html#route_dumb_mx">Accept-Then-Bounce</a></li>
			</ul>
		<li><a href="route-map.html#route_auth_support">AUTH Support</a></li>
		<li><a href="route-map.html#route_etrn_support">ETRN Support</a></li>
		</ul>
	<li><a href="access-map.html">The Access Map</a></li>
		<ul>
		<li><a href="access-map.html#access_lookups">Lookup Sequences</a></li>
		<li><a href="access-map.html#access_tags">Tags</a></li>
		<li><a href="access-map.html#access_about_delay_checks">About Delay Checks</a></li>
		<li><a href="access-map.html#access_simple_value">Right Hand Side Values</a></li>
		<li><a href="access-map.html#access_action_words">Action Words</a></li>
		<li><a href="access-map.html#access_pattern_lists">Pattern Lists</a></li>
		<li><a href="access-map.html#access_simple_pattern">!Simple Patterns!</a></li>
		<li><a href="access-map.html#access_regex_pattern">/Regular Expression Patterns/</a></li>
		</ul>

	<li><a href="@PACKAGE_NAME@-cf.html">The @PACKAGE_NAME@.cf File</a></li>
		<ul>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_avastd">Avast! AV Support</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_cache">Cache Options</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_call_back">Call-Backs</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_clamd">Clam AV Support</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_cli">Command-Line Interface</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_client_is_mx">Client IP Address</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_concurrent">Concurrency &amp; Rate</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_dns_bl">DNS Based Lists</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_delay_checks">Delay Checks</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_emew">EMEW</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_fpscand">F-Prot AV Support</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_grey_list">Grey Listing</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_grey_content">Grey Content</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_helo">SMTP HELO Testing</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_interface">Network Interface</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_length_limit">Length &amp; Limits</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_rfc">RFC Conformance</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_run">Run Settings</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_server">Server Performance</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_siq">SIQ Support</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_smtp">SMTP Options</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_savdid">Sophos AV Support</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_spamd">SpamAssassin Support</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_spf">SPF Support</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_stats">Statistics</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_uri">URI Blacklists</a></li>
		<li><a href="@PACKAGE_NAME@-cf.html#smtpf_verbose">Verbose Logging</a></li>
		</ul>
	<li><a href="summary.html">Option Summary</a></li>
	</ol>
<li>Runtime</li>
	<ol type="a">
	<li><a href="runtime.html#command_options">Command Line Options</a></li>
	<li><a href="runtime.html#runtime_config">Runtime Configuration</a></li>
	<li><a href="runtime.html#cache_file">The Cache File</a></li>
		<ul>
		<li><a href="runtime.html#cache_structure">The Cache Structure</a></li>
		</ul>
	<li><a href="runtime.html#stats_file">The Stats File</a></li>
		<ul>
		<li><a href="runtime.html#stats_structure">The Stats Structure</a></li>
		</ul>
	<li><a href="syslog.html">Log Messages</a></li>
	<li><a href="reply.html">SMTP Replies</a></li>
	</ol>
<li><a class="glossary" href="glossary.html">Glossary</a></li>
</ol>
</div>


<a name="Summary"></a>
<h3>Option Syntax</h3>
<p>
Options can be expressed in four different ways. Boolean options
are expressed as <span class="option">+option</span> or <span class="option">-option</span> to turn the option on or off
respectively. Numeric, string, and list options are expressed as
<span class="option">option=value</span> to set the option or <span class="option">option+=value</span> to append to a
list. Note that the <span class="option">+option</span> and <span class="option">-option</span> syntax are equivalent to
<span class="option">option=1</span> and <span class="option">option=0</span> respectively. String values containing white
space must be quoted using single (') or double (") quotes. Option
names are case insensitive.
</p>
<p>
Some options, like <span class="option">+help</span> or <span class="option">-help</span>, are treated as immediate
actions or commands. Unknown options are ignored and not reported.
The first command-line argument is that which does not adhere to
the above option syntax. The special command-line argument <span class="option">--</span> can
be used to explicitly signal an end to the list of options.
</p>
<p>
The default options, as shown below, can be altered by specifying
them on the command-line or within an option <a href="#opt_file">file</a>, which simply
contains command-line options one or more per line and/or on
multiple lines. Comments are allowed and are denoted by a line
starting with a hash (#) character. If the file option is defined
and not empty, then it is parsed first, followed by the command
line options.
</p>

<p>
Option names that start with a leading underscore (_) are considered
experimental and subject to change or be removed from future builds.
They should not normally be used on production systems.
</p>

<h3>Option Summary</h3>
<dl>

<a name="opt_access_map"></a>
<dt><span class="option">access-map</span>=<span class="value">sql!/etc/@PACKAGE_NAME@/access.sq3</span></dt>
<dd>
The type and location of the read-only access key-value map.
It provides a centralised means to black and white list hosts,
domains, mail addresses, etc. The following methods are supported:

<blockquote>
<table border="0" cellspacing="0" cellpadding="0">
<!--
<tr><td class="value tline">text!/path/map.txt</td>					</tr>
-->
<tr><td class="value">sql!/path/database</td>						</tr>
<tr><td class="value">socketmap!host:port</td>						</tr>
<tr><td class="value">socketmap!/path/local/socket</td>				</tr>
<tr><td class="value">socketmap!123.45.67.89:port</td>				</tr>
<tr><td class="value bline">socketmap![2001:0DB8::1234]:port</td>	</tr>
</table>
</blockquote>

<p>
For those locations that specify a <code>host:port</code>, if <code>:port</code> is omitted, the default is 7953.
</p>
<p>
The <span class="option">access-map</span> contains key-value pairs. Lookups are performed
from most to least specific, stopping on the first entry found.
Keys are case-insensitive.
</p>
<p>
An IPv4 lookup is repeated several times reducing the IP address
by one octet from right to left until a match is found.
</p>
<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td><span class="tag">tag:</span>192.0.2.9</td></tr>
<tr><td><span class="tag">tag:</span>192.0.2</td></tr>
<tr><td><span class="tag">tag:</span>192.0</td></tr>
<tr><td><span class="tag">tag:</span>192</td></tr>
</table>
</blockquote>
<p>
An IPv6 lookup is repeated several times reducing the IP address
by one 16-bit word from right to left until a match is found.
</p>
<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0:0:0:1234:5678</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0:0:0:1234</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0:0:0</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0:0</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0:0</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8:0</td></tr>
<tr><td><span class="tag">tag:</span>2001:0DB8</td></tr>
<tr><td><span class="tag">tag:</span>2001</td></tr>
</table>
</blockquote>
<p>

 A domain lookup is repeated several times reducing the domain by
 one label from left to right until a match is found.

</p>
<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td><span class="tag">tag:</span>[ipv6:2001:0DB8::1234:5678]</td></tr>
<tr><td><span class="tag">tag:</span>[192.0.2.9]</td></tr>
<tr><td><span class="tag">tag:</span>sub.domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>tld</td></tr>
<tr><td><span class="tag">tag:</span></td></tr>
</table>
</blockquote>
<p>

 An email lookup is similar to a domain lookup, the exact address
 is first tried, then the address's domain, and finally the local
 part of the address.

</p>
<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td><span class="tag">tag:</span>account@sub.domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>sub.domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>domain.tld</td></tr>
<tr><td><span class="tag">tag:</span>tld</td></tr>
<tr><td><span class="tag">tag:</span>account@</td></tr>
<tr><td><span class="tag">tag:</span></td></tr>
</table>
</blockquote>
<p>
The tags <span class="tag">Connect:</span>, <span class="tag">Helo:</span>, <span class="tag">From:</span>, and <span class="tag">To:</span> are used for black / white list
lookup by connecting client IP or domain, HELO/EHLO argument, sender address,
and recipient address respectively. Other options may specify other tags.
See the <a href="access-map.html">access-map</a> chapter.
</p>
<p>
If a key is found, then the value is processed as a pattern list
and the result returned. A pattern list is a whitespace separated
list of <i class="syntax">pattern-action</i> pairs followed by an optional default
action. The support pattern formats are:
</p>
<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td class="value tline" width="50%">[network/cidr]action</td><td class="tline">Classless Inter-Domain Routing</td></tr>
<tr><td class="value">!pattern!action</td><td>Simple fast text matching.</td></tr>
<tr><td class="value bline">/regex/action</td><td class="bline">Extended Regular Expressions</td></tr>
</table>
</blockquote>
<p>

 The CIDR will only ever match for IP address related lookups.
</p>
<p>

 A <span class="value">!pattern!</span> uses an asterisk (*) for a wildcard, scanning over
 zero or more characters; a question-mark (?) matches any single
 character; a backslash followed by any character treats it as a
 literal (it loses any special meaning).

</p>
<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr valign="top"><td class="value tline" width="50%">!abc!</td><td class="tline">exact match for 'abc'</td></tr>
<tr valign="top"><td class="value">!abc*!</td><td>match 'abc' at start of string</td></tr>
<tr valign="top"><td class="value">!*abc!</td><td>match 'abc' at the end of string</td></tr>
<tr valign="top"><td class="value">!abc*def!</td><td>match 'abc' at the start and match 'def' at the end, maybe with stuff in between.</td></tr>
<tr valign="top"><td class="value bline">!*abc*def*!</td><td class="bline">find 'abc', then find 'def'</td></tr>
</table>
</blockquote>
<p>

For black-white lookups, the following actions are recognised:

OK (white list),
CONTENT	(white list pre-DATA)
DISCARD (accept &amp; discard),
SPF-PASS (white-list sender if SPF passed),
REJECT (black list),
IREJECT (black list immediately),
TEMPFAIL,
SAVE (save copy if delivered),
TRAP (accept, save, but do not deliver),
TAG (tag Subject instead of reject or drop),
SKIP or DUNNO (stop lookup, no result),
and NEXT (opposite of SKIP, resume lookup).

It is possible to specify an empty action
after a pattern, which is treated like SKIP returning an undefined
result. Other options may specify other actions.
</p>
</dd>

<a name="opt_access_tag_words"></a>
<dt>&plusmn;<span class="option">access-tag-words</span></dt>
<dd>
Write to standard output access-map action tag and valid word mapping.
</dd>

<a name="opt_access_tag_words"></a>
<dt>&plusmn;<span class="option">access-word-tags</span></dt>
<dd>
Write to standard output access-map action word and valid tag mapping.
</dd>

<a name="opt_auth_delay_checks"></a>
<dt>-<span class="option">auth-delay-checks</span></dt>
<dd>
Delay some client connection and HELO tests until MAIL FROM:
to allow the sender to authenticate using the AUTH command.
</dd>

<a name="opt_avastd_policy"></a>
<dt><span class="option">avastd-policy</span>=<span class="value">reject</span></dt>
<dd>
Policy to apply if message is infected. Specify either none, reject, or discard.
</dd>

<a name="opt_avastd_socket"></a>
<dt><span class="option">avastd-socket</span>=<span class="value"></span></dt>
<dd>
The unix domain socket or Internet host[:port] of the avastd
server. Specify the empty string to disable avastd scan. The
default clamd port is 5037.
</dd>

<a name="opt_avastd_timeout"></a>
<dt><span class="option">avastd-timeout</span>=<span class="value">120</span></dt>
<dd>
The avastd I/O timeout in seconds.</dd>
</dd>

<a name="opt_cache_accept_ttl"></a>
<dt><span class="option">cache-accept-ttl</span>=<span class="value">604800</span></dt>
<dd>
Cache time-to-live in seconds for positive results. A record will
be maintained as long as there is regular activity.
</dd>

<a name="opt_cache_gc_interval"></a>
<dt><span class="option">cache-gc-interval</span>=<span class="value">300</span></dt>
<dd>
Cache garbage collection interval in seconds.
</dd>

<a name="opt_cache_multicast_ip"></a>
<dt><span class="option">cache-multicast-ip</span>=<span class="value"></span></dt>
<dd>
The Multicast Cache facility provides the ability to share cache
updates between two or more machines on the same network segment.
The multicast group can be an IPv4 or IPv6 address plus an optional
port. For IPv4, RFC 3171 reserves 232/8 for one-to-
many applications. RFC 3513 outlines multicast IPv6 assignment and
it is recommended to use something within FF12/16 for link-local. To
disable the multicast cache updates, specify the empty string.
</dd>

<a name="opt_cache_multicast_port"></a>
<dt><span class="option">cache-multicast-port</span>=<span class="value">6920</span></dt>
<dd>
The listener port for multicast cache updates.
</dd>

<a name="opt_cache_multicast_ttl"></a>
<dt><span class="option">cache-multicast-ttl</span>=<span class="value">1</span></dt>
<dd>
The multicast TTL value to be applied to broadcast packets.
</dd>

<a name="opt_cache_on_corrupt"></a>
<dt><span class="option">cache-on-corrupt</span>=<span class="value">replace</span></dt>
<dd>
Action taken if cache corruption is detected. Set to one of: exit,
rename, or replace. This is intended for debugging.
</dd>

<a name="opt_cache_path"></a>
<dt><span class="option">cache-path</span>=<span class="value">/var/db/@PACKAGE_NAME@/cache.sq3</span></dt>
<dd>
The file path of the SQLite3 cache. The directory containing the
cache must be read-writable by the process so that SQLite3 can
create journal files as required.
</dd>

<a name="opt_cache_reject_ttl"></a>
<dt><span class="option">cache-reject-ttl</span>=<span class="value">604800</span></dt>
<dd>
Cache time-to-live in seconds for reject results.
</dd>

<a name="opt_cache_secret"></a>
<dt><span class="option">cache-secret</span>=<span class="value"></span></dt>
<dd>
The Multicast &amp; Unicast Cache facility broadcasts UDP packets in the
clear on the link-local network segment or direct to a set of hosts.
In order to identify valid broadcasts, each participating machine
must have the same shared secret used to generate and validate the
cache updates.
</dd>

<a name="opt_cache_secret"></a>
<dt><span class="option">cache-sync-mode</span>=<span class="value">off</span></dt>
<dd>
Cache synchronisation mode. Set to one of: off, normal, or full. The
normal and full modes improve reliability at the sake of speed.
</dd>

<a name="opt_cache_temp_fail_ttl"></a>
<dt><span class="option">cache-temp-fail-ttl</span>=<span class="value">7200</span></dt>
<dd>
Cache time-to-live in seconds for temporary failure results.
</dd>

<!--
<a name="opt_cache_unicast_domain"></a>
<dt><span class="option">cache-unicast-domain</span>=<span class="value"></span></dt>
<dd>
The Unicast Cache facility provides the ability to broadcast cache
updates to a set of remote hosts beyond the local network segment.
The specified domain is used to obtain the list of MX hosts that
are assumed to be participating in cache updates. To disable the
unicast cache updates, specify the empty string.
</dd>
-->

<a name="opt_cache_unicast_hosts"></a>
<dt><span class="option">cache-unicast-hosts</span>=<span class="value"></span></dt>
<dd>
The Unicast Cache facility provides the ability to broadcast cache
updates to a set of remote hosts beyond the local network segment.
A space or comma separated list of host names and/or IP addresses
with optional colon separated port numbers. This option and
<a href="#opt_cache_unicast_domain">cache-unicast-domain</a> are mutually exclusive.
</dd>

<a name="opt_cache_unicast_port"></a>
<dt><span class="option">cache-unicast-port</span>=<span class="value">6921</span></dt>
<dd>
The listener port for unicast cache updates.
</dd>

<a name="opt_call_ahead_as_sender"></a>
<dt>-<span class="option">call-ahead-as-sender</span></dt>
<dd>
When set, perform the call-ahead using the original MAIL FROM:<sender>
instead of the MAIL FROM:<> (null sender). Some down stream mail stores
reject MAIL FROM:<> or reject a sender at RCPT TO:
</dd>

<a name="opt_call_back"></a>
<dt>-<span class="option">call-back</span></dt>
<dd>
When set, performs sender address verification using a call-back to
one of the sender's MX hosts. Note that this form of test is very
unpopular with large mail services for a variety of reasons such
as resource consumption and that it can be abused for proxied
dictionary harvesting attacks. Use of this test could result in
black listing of your host by those services. Use with care.
</dd>

<a name="opt_call_back_pass_grey"></a>
<dt>-<span class="option">call-back-pass-grey</span></dt>
<dd>
If the call-back returns a pass result, then skip grey-listing.
</dd>

<a name="opt_call_back_strict_greeting"></a>
<dt>-<span class="option">call-back-strict-greeting</span></dt>
<dd>
During a call-back, require that the first word of the 220 response
is a FQDN, otherwise fail the call-back. See RFC 2821 section 4.2
grammar for greeting and section 4.3.1 paragraph 3.
</dd>

<a name="opt_call_back_uri_greeting"></a>
<dt>-<span class="option">call-back-uri-greeting</span></dt>
<dd>
During a call-back, URI BL test the FQDN host name given by the 220
response. The call-back fails if the host name is listed.
</dd>

<a name="opt_clamd_max_size"></a>
<dt><span class="option">clamd-max-size</span>=<span class="value">10000</span></dt>
<dd>
Max. number of kilobytes to pass to clamd, 0 for unlimited.
</dd>

<a name="opt_clamd_policy"></a>
<dt><span class="option">clamd-policy</span>=<span class="value">reject</span></dt>
<dd>
Policy to apply if message is infected. Specify either none,
reject, or discard.
</dd>

<a name="opt_clamd_scan_all"></a>
<dt>+<span class="option">clamd-scan-all</span></dt>
<dd>
When set, scan all messages for viruses. ClamAV can also scan for
phishing scams. Otherwise, as an optimisation, only scan messages
with attachments for viruses.
</dd>

<a name="opt_clamd_socket"></a>
<dt><span class="option">clamd-socket</span>=<span class="value"></span></dt>
<dd>
The unix domain socket or Internet host[:port] of the clamd
server. Specify the empty string to disable clamd scan. The
default clamd port is 3310. If clamd is running on the same
host as smtpf, then the special token SCAN can be specified
to use scanning by file path instead of by socket stream for
an I/O efficiency gain.
</dd>

<a name="opt_clamd_timeout"></a>
<dt><span class="option">clamd-timeout</span>=<span class="value">120</span></dt>
<dd>
The clamd I/O timeout in seconds.
</dd>

<!--
<a name="opt_cli_content"></a>
<dt><span class="option">cli-content</span>=<span class="value"></span></dt>
<dd>
The absolute file path of a CLI script or program used to filter
message content. This command is initiated after the cli-envelope
option and just before returning a 354 response to the DATA command.
The mesasge content is later passed as to the CLI as it is received.
<p>
The command first reads from standard input, until EOF, a simulated
Return-Path header with the sender's address, our Received header
containing client connection details and message queue ID, followed
by the original message headers, and content. The command may write
to standard output a report. Standard error is merged with standard
output.
</p>
<p>
The command must exit with one of the following values:
</p>
<blockquote>
<table width="100%">
<tr valign="top"><td width="5%">0</td><td>Continue; standard output is logged.</td></tr>
<tr valign="top"><td>1</td><td>Reserved.</td></tr>
<tr valign="top"><td>2</td><td>Reserved.</td></tr>
<tr valign="top"><td>3</td><td>Reserved.</td></tr>
<tr valign="top"><td>4</td><td>Reserved.</td></tr>
<tr valign="top"><td>5</td><td>Permanent reject the message with 550 5.7.1; lines from
standard output will be used for the SMTP response.</td></tr>
<tr valign="top"><td>6</td><td>Discard the message; standard output is logged.</td></tr>
<tr valign="top"><td>7</td><td>Drop the client connection; standard output is logged.</td></tr>
</table>
</blockquote>
<p>
Any other values are reserved for future use.
</p>
</dd>

<a name="opt_cli_envelope"></a>
<dt><span class="option">cli-envelope</span>=<span class="value"></span></dt>
<dd>
The absolute file path of a CLI script or program used to filter
envelope details. This command is executed when the DATA command
is sent by the client. The response from the CLI can reject the
DATA command.
<p>
The command reads the following lines from standard input: the
client IP, the client PORT, the client name, the HELO/EHLO
argument, the MAIL FROM: argument, the message queue ID, and one
or more RCPT TO: arguments until EOF. The command may write to
standard output a report. Standard error is merged with standard
output.
</p>
<p>
The command must exit with one of the following values:
</p>
<blockquote>
<table width="100%">
<tr valign="top"><td width="5%">0</td><td>Continue; standard output is logged.</td></tr>
<tr valign="top"><td>1</td><td>Reserved.</td></tr>
<tr valign="top"><td>2</td><td>Reserved.</td></tr>
<tr valign="top"><td>3</td><td>Reserved.</td></tr>
<tr valign="top"><td>4</td><td>Temporary reject the message with 450 4.7.1; lines from
standard output will be used for the SMTP response.</td></tr>
<tr valign="top"><td>5</td><td>Permanent reject the message with 550 5.7.1; lines from
standard output will be used for the SMTP response.</td></tr>
<tr valign="top"><td>6</td><td>Discard the message; standard output is logged.</td></tr>
<tr valign="top"><td>7</td><td>Drop the client connection; standard output is logged.</td></tr>
</table>
</blockquote>
<p>
Any other values are reserved for future use.
</p>
</dd>

<a name="opt_cli_timeout"></a>
<dt><span class="option">cli-timeout</span>=<span class="value">60</span></dt>
<dd>
The CLI I/O timeout in seconds.
</dd>
-->

<a name="opt_click_secret"></a>
<dt><span class="option">click-secret</span>=<span class="value"></span></dt>
<dd>
Specify a phrase used to generate and validate a click challenge. Be
sure to quote the string if it contains white space.
</dd>

<a name="opt_click_ttl"></a>
<dt><span class="option">click-ttl</span>=<span class="value">90000</span></dt>
<dd>
Time-to-live in seconds for click challenge links.
</dd>

<a name="opt_click_url"></a>
<dt><span class="option">click-url</span>=<span class="value"></span></dt>
<dd>
Specify either an empty string, <code>mailto</code>, or an http URL. If set to
<code>mailto</code>, then reject messages are appended with a special mail address
that a sender can mail in order to get temporarily white listed.
<p>
If set to an http: URL, then a reject messages are appended with a URL that
the sender can click on in order to get temporarily white listed. The
<span class="option">click-url</span> is
suffixed with query string parameters, where
<span class="key">c=</span> is the trimmed PTR or IP of the sender
(see <a href="#opt_grey_key">grey-key</a>), a comma, and the sender's
mail address; the <span class="key">h=</span> is the ASCII encoded time stamp
and MD5 hash generated from the binary value of the timestamp,
the <a href="#opt_click_secret">click-secret</a>,
and the <span class="key">c=</span> value.
</p>
<p>
Otherwise set to empty string to disable this facility.
</p>
</dd>

<a name="opt_client_ip_in_ptr"></a>
<dt>-<span class="option">client-ip-in-ptr</span></dt>
<dd>
Apply a pattern heuristic to the connected client's PTR record.
Reject if it looks like it is composed from the client IP address.
See also <a href="#opt_client_is_mx">client-is-mx</a>.
</dd>

<a name="opt_client_is_mx"></a>
<dt>-<span class="option">client-is-mx</span></dt>
<dd>
Weaken rejects based on <a href="#opt_client_ptr_required">client-ptr-required</a> or
<a href="#opt_client_ip_in_ptr">client-ip-in-ptr</a>
until the sender address is known. If the client IP and sender combination
pass SPF or the client IP is an MX for the sender, then ignore the results of client-ptr-required and
client-ip-in-ptr. Otherwise reject if client-ptr-required is false or client-ip-in-ptr is true.
</dd>

<a name="opt_client_ptr_required"></a>
<dt>-<span class="option">client-ptr-required</span></dt>
<dd>
The connecting client IP address must have a PTR record. See also
<a href="#opt_client_is_mx">client-is-mx</a>.
</dd>

<a name="opt_concurrent_connection_control"></a>
<dt><span class="option">Concurrent Connection Control</span></dt>
<dd>
The tag <span class="tag">Concurrent-Connect:</span> can be used in the <a href="#opt_access_map">access-map</a>.
<p>
If a key is found, then the value is processed as a pattern list
and the result returned. A positive integer value is specified in
place of an action and is the maximum number of concurrent
connections permitted at any one time.
</p>
</dd>

<a name="opt_connection_rate_control"></a>
<dt><span class="option">Connection Rate Control</span></dt>
<dd>
The tag <span class="tag">Rate-Connect:</span> can be used in the <a href="#opt_access_map">access-map</a>.
<p>
If a key is found, then the value is processed as a pattern list
and the result returned. An integer, in place of an action word,
specifies the number of connections per minute allowed. Specify
zero (0) connections to disable the rate limit.
</p>
</dd>

<a name="opt_ctasd_policy"></a>
<dt><span class="option">ctasd-policy</span>=<span class="value">reject</span></dt>
<dd>
Policy to apply if message is infected. Specify either none,
reject, or discard.
</dd>

<a name="opt_ctasd_socket"></a>
<dt><span class="option">ctasd-socket</span>=<span class="value"></span></dt>
<dd>
The unix domain socket or Internet host[:port] of the
<a href="http://www.commtouch.com/">CommTouch</a>
Advanced Security daemon (ctasd). Specify the empty string to disable
ctasd scan. The default ctasd port is 8088.
</dd>

<a name="opt_ctasd_stream"></a>
<dt>-<span class="option">ctasd-stream</span></dt>
<dd>
When set, the message is streamed to the ctasd server, otherwiese
the message is passed by temporary file reference.
<span class="note">Currently ctasd does not properly support true
inline streaming, so this option should remain unset.</a>
</dd>

<a name="opt_ctasd_subject_tag"></a>
<dt><span class="option">ctasd-subject-tag</span>=<span class="value">[SUSPECT]</span></dt>
<dd>
When the ctasd server reports the message as suspicious then the Subject
header is prepended with this tag to identify suspect messages. Specify
the empty string to disable the subject tag.
</dd>

<a name="opt_ctasd_timeout"></a>
<dt><span class="option">ctasd-timeout</span>=<span class="value">120</span></dt>
<dd>
The ctasd I/O timeout in seconds.
</dd>

<a name="opt_daemon"></a>
<dt>+<span class="option">daemon</span></dt>
<dd>
Start as a background daemon or foreground application.
</dd>

<a name="opt_deny_compressed_name"></a>
<dt><span class="option">deny-compressed-name</span>=<span class="value">*.bat</span></dt>
<dt><span class="option">deny-compressed-name</span>+=<span class="value">*.com</span></dt>
<dt><span class="option">deny-compressed-name</span>+=<span class="value">*.cpl</span></dt>
<dt><span class="option">deny-compressed-name</span>+=<span class="value">*.exe</span></dt>
<dt><span class="option">deny-compressed-name</span>+=<span class="value">*.inf</span></dt>
<dt><span class="option">deny-compressed-name</span>+=<span class="value">*.msi</span></dt>
<dt><span class="option">deny-compressed-name</span>+=<span class="value">*.msp</span></dt>
<dt><span class="option">deny-compressed-name</span>+=<span class="value">*.pif</span></dt>
<dt><span class="option">deny-compressed-name</span>+=<span class="value">*.scr</span></dt>
<dd>
A list of unacceptable file patterns to reject
when found RAR or ZIP attachments. The default list consists of unsafe
Windows file extensions as given by Microsoft. Specify an empty list
to disable.
</dd>

<a name="opt_deny_content"></a>
<dt>-<span class="option">deny-content</span></dt>
<dd>
When enabled, then deny-content-* options are applied.
</dd>

<a name="opt_deny_content_name"></a>
<dt><span class="option">deny-content-name</span>=<span class="value">*.adp</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.bas</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.bat</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.chm</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.cmd</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.com</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.cpl</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.crt</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.exe</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.hlp</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.hta</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.inf</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.ins</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.isp</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.js</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.jse</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.lnk</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.mdb</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.mde</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.msc</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.msi</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.msp</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.mst</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.pcd</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.pif</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.reg</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.scr</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.sct</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.shs</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.shb</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.url</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.vb</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.vbe</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.vbs</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.wsc</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.wsf</span></dt>
<dt><span class="option">deny-content-name</span>+=<span class="value">*.wsh</span></dt>
<dd>
A list of unacceptable file patterns to reject
when found as MIME attachments. The default list consists of unsafe
Windows file extensions as given by Microsoft. Specify an empty list
to disable.
</dd>

<a name="opt_deny_content_type"></a>
<dt><span class="option">deny-content-type</span>=<span class="value">application/*executable</span></dt>
<dt><span class="option">deny-content-type</span>+=<span class="value">application/*msdos-program</span></dt>
<dt><span class="option">deny-content-type</span>+=<span class="value">message/partial</span></dt>
<dd>
A list of unacceptable attachment MIME types to reject.
Specify an empty list to disable.
</dd>

<a name="opt_deny_top_content_type"></a>
<dt><span class="option">deny-top-content-type</span>=<span class="value">application/*</span></dt>
<dd>
A list of unacceptable message MIME types to reject.
Specify an empty list to disable.
</dd>

<a name="opt_digest_bl"></a>
<dt><span class="option">digest-bl</span>=<span class="value"></span></dt>
<dd>
A list of MD5 digest based BL suffixes to consult.
Aggregate lists are supported using suffix/mask. Without a /mask, suffix
is the same as suffix/0x00FFFFFE.
</dd>

<a name="opt_dns_bl"></a>
<dt><span class="option">dns-bl</span>=<span class="value"></span></dt>
<dd>
A list of IP based DNS BL suffixes to consult, like sbl-xbl.spamhaus.org.
Aggregate lists are supported using suffix/mask. Without a /mask, suffix
is the same as suffix/0x00FFFFFE.
</dd>

<a name="opt_dns_bl_headers"></a>
<dt><span class="option">dns-bl-headers</span>=<span class="value"></span></dt>
<dd>
A semi-colon separated list of mail headers to parse for IP addresses and check against
one or more DNS BL. Specify the empty list to disable.
</dd>

<a name="opt_dns_gl"></a>
<dt><span class="option">dns-gl</span>=<span class="value"></span></dt>
<dd>
A list of IP based DNS grey-list suffixes to consult. This is similar
to dns-wl, but only white lists as far as, but not including, the data content filters.
Intended for use with less reliable DNS white lists. Aggregate lists
are supported using suffix/mask. Without a /mask, suffix is the same
as suffix/0x00FFFFFE.
</dd>

<a name="opt_dns_max_timeout"></a>
<dt><span class="option">dns-max-timeout</span>=<span class="value">45</span></dt>
<dd>
Maximum timeout in seconds for a DNS query.
</dd>

<a name="opt_dns_round_robin"></a>
<dt>-<span class="option">dns-round-robin</span></dt>
<dd>
Set true to query NS servers in round robin order. Set false to
query all the NS servers in parallel.
</dd>

<a name="opt_dns_wl"></a>
<dt><span class="option">dns-wl</span>=<span class="value"></span></dt>
<dd>
A list of IP based DNS WL suffixes to consult.
Aggregate lists are supported using suffix/mask. Without a /mask, suffix
is the same as suffix/0x00FFFFFE.
</dd>

<a name="opt_domain_bl"></a>
<dt><span class="option">domain-bl=</span><span class="value">.dbl.spamhaus.org</span></dt>
<dd>
A list of domain black list suffixes to consult, like .dbl.spamhaus.org.
The host or domain name found in a URI is checked against these DNS black
lists. These black lists are assumed to use wildcards entries, so only a
single lookup is done. IP-as-domain in a URI are ignored.
</dd>

<a name="opt_dupmsg_track_all"></a>
<dt>-<span class="option">dupmsg-track-all</span></dt>
<dd>
When set, we track all <code>Message-ID</code> headers received and reject any duplicates
messages that arrive again. This can prevent some types of spam from
being sent repeatedly, however it will greatly increase the size of
the cache on high volume systems and so should be used with care.
</dd>

<a name="opt_dupmsg_ttl"></a>
<dt><span class="option">dupmsg-ttl</span>=<span class="value">90000</span></dt>
<dd>
Time-to-live in seconds for duplicate message tracking records. These
records are created in the event that there was an I/O error while
sending a 250 message accepted reply and have successfully relayed the
message to the forward host(s), in which case record the message ID in
order accept and discard future retries of the same message and so avoid
duplicates.
</dd>

<!-- -->
<a name="opt_emew_dsn_policy"></a>
<dt><span class="option">emew-dsn-policy</span>=<span class="value">none</span></dt>
<dd>
If the message is a DSN or MDN and does not contain a reference to
an enhanced Message-ID that originated here, then apply the given
policy, which can be either reject or none.
</dd>

<a name="opt_emew_secret"></a>
<dt><span class="option">emew-secret</span>=<span class="value"></span></dt>
<dd>
Specify a phrase used to generate and validate an enhanced Message-ID.
Be sure to quote the string if it contains white space. Specify the
empty string to disable enhanced Message-ID support.
</dd>

<a name="opt_emew_ttl"></a>
<dt><span class="option">emew-ttl</span>=<span class="value">604800</span></dt>
<dd>
Time-to-live in seconds for an enhanced Message-ID header. Messages
referring to stale mail that originated here are rejected. This limits
the window of opportunity for replay attacks.
</dd>

<a name="opt_file"></a>
<dt><span class="option">file</span>=<span class="value">/etc/@PACKAGE_NAME@/@PACKAGE_NAME@.cf</span></dt>
<dd>
Read option file before command line options.
</dd>

<!--
<a name="opt_fpscand_max_size"></a>
<dt><span class="option">fpscand-max-size</span>=<span class="value">0</span></dt>
<dd>
Max. number of kilobytes to pass to fpscand, 0 for unlimited.
</dd>
-->

<a name="opt_fpscand_policy"></a>
<dt><span class="option">fpscand-policy</span>=<span class="value">reject</span></dt>
<dd>
Policy to apply if message is infected. Specify either none,
reject, or discard.
</dd>

<a name="opt_fpscand_socket"></a>
<dt><span class="option">fpscand-socket</span>=<span class="value"></span></dt>
<dd>
The unix domain socket or Internet host[:port] of the fpscand
server. Specify the empty string to disable fpscand scan. The
default fpscand port is 10200.
</dd>

<a name="opt_fpscand_timeout"></a>
<dt><span class="option">fpscand-timeout</span>=<span class="value">120</span></dt>
<dd>
The fpscand I/O timeout in seconds.
</dd>

<a name="opt_grey_content"></a>
<dt>-<span class="option">grey-content</span></dt>
<dd>
Content based grey listing. After all other content filters
have passed over a message and when the grey-list key tuple has not been
previously seen, we store a hash for the message and temporarily reject it,
and grey-list at DATA until the <a href="#opt_grey_temp_fail_period">grey-temp-fail-period</a> expires. If the same
message returns and matches the previously stored hash, then update the
grey-list record to a pass. All other messages from the matching grey-list
key tuple are temporarily rejected until the previously hashed message is
sent again.
</dd>

<a name="opt_grey_content_save"></a>
<dt>-<span class="option">grey-content-save</span></dt>
<dd>
When set, save the DATA content that is hashed to a file in the
save-dir directory. Intended for testing and diagnosis.
</dd>

<a name="opt_grey_key"></a>
<dt><span class="option">grey-key</span>=<span class="value">ptr,mail,rcpt</span></dt>
<dd>
A comma separated list of what composes the grey-list key: ip,
ptr, helo, mail, rcpt. The ptr element is the PTR record for the
connecting client minus the first label, so if host.example.com is
the returned PTR value, then example.com is the value used. If there is
no PTR record found or the client IP appears to be a dynamic IP,
then the client IP address is used. Specify the empty string to
disable grey-listing.
</dd>

<a name="opt_grey_report_header"></a>
<dt><span class="option">grey-report-header</span>=<span class="value">X-Grey-Report</span></dt>
<dd>
The name of the grey report header. Empty string to disable.
</dd>

<a name="opt_grey_temp_fail_period"></a>
<dt><span class="option">grey-temp-fail-period</span>=<span class="value">600</span></dt>
<dd>
This is the amount of time in seconds a correspondent's grey-list
record will be temporarily rejected before being upgraded to a pass.
<p>
The tags <span class="tag">Grey-Connect:</span> and <span class="tag">Grey-To:</span>
can be used in the <a href="#opt_access_map">access-map</a> to override
this option's value.
If a key is found, then the value is processed as a pattern list
and the result returned. An integer, in place of an action word,
specifies the number of seconds to temporarily reject a client.
If several <span class="tag">Grey-Connect:</span> and <span class="tag">Grey-To:</span> keys are found, then the minimum value is used.
Specify zero (0) seconds to disable grey listing.
</p>
</dd>

<a name="opt_grey_temp_fail_ttl"></a>
<dt><span class="option">grey-temp-fail-ttl</span>=<span class="value">90000</span></dt>
<dd>
Cache time-to-live in seconds to retain grey-list record that are
in the temporary rejection state.
</dd>

<a name="opt_helo_claims_us"></a>
<dt>+<span class="option">helo-claims-us</span></dt>
<dd>
Drop any host that claims to be from a domain we are responsible
for in the HELO/EHLO argument.
</dd>

<a name="opt_helo_ip_mismatch"></a>
<dt>-<span class="option">helo-ip-mismatch</span></dt>
<dd>
Drop any host that specifies an IP address as the HELO argument
that does not correspond to the connecting client's IP, excluding
RFC 3330 IP addresses reserved for LANs.
</dd>

<a name="opt_helo_is_ptr"></a>
<dt>-<span class="option">helo-is-ptr</span></dt>
<dd>
If the HELO argument is the same as the PTR name and the PTR record
is an instance of client IP-in-PTR, then reject the HELO command. See
also <a href="#opt_client_is_mx">client-is-mx</a>.
</dd>

<a name="opt_help"></a>
<dt>&plusmn;<span class="option">help</span></dt>
<dt><span class="option">help</span>=<span class="value">filepath</span></dt>
<dd>
Write the option summary to standard output and exit. The output
is suitable for use as an option file. For Windows this option
can be assigned a file path string to save the output to a file,
eg. help=./smtpf.cf.txt
</dd>

<a name="opt_http_timeout"></a>
<dt><span class="option">http-timeout</span>=<span class="value">60</span></dt>
<dd>
Socket timeout used when testing HTTP links.
</dd>

<a name="opt_idle_retest_timer"></a>
<dt><span class="option">idle-retest-timer</span>=<span class="value">300</span></dt>
<dd>
Periodically reapply some tests, such as dns-bl, on long running
connections. Specify zero (0) to disable.
</dd>

<a name="opt_info"></a>
<dt>&plusmn;<span class="option">info</span></dt>
<dd>
Write the configuration and compile time options to standard output
and exit.
</dd>

<!--
<a name="opt_interface_ip"></a>
<dt><span class="option">interface-ip</span>=<span class="value">0.0.0.0:25</span></dt>
<dd>
The IP address and optional port to listen on. When undefined,
then the IP address will be determined at start-up. If the port
is not specified, then SMTP port 25 is the assumed.
</dd>

<a name="opt_interface_name"></a>
<dt><span class="option">interface-name</span>=<span class="value"></span></dt>
<dd>
One of the FQDN for this host. If empty, then the host name will
be automatically determined at start-up. If interface-ip is
undefined, then the name specified here or determined at start-up
will select the IP address used.
</dd>
-->

<a name="opt_interfaces"></a>
<dt><span class="option">interfaces</span>=<span class="value">[::0]:25; 0.0.0.0:25</span></dt>
<dd>
A semi-colon separared list of interface host names or IP addresses
on which to bind and listen for new connections. They can be IPv4
and/or IPv6.
</dd>

<a name="opt_lickey_file"></a>
<dt><span class="option">lickey-file</span>=<span class="value">/etc/smtpf/lickey.txt</span></dt>
<dd>
The license key file.
</dd>

<a name="opt_lint"></a>
<dt>-<span class="option">lint</span></dt>
<dd>
Lint SMTP sessions and messages for as many issues as possible. A
report of the results is sent to postmaster. This option requires
a special license key.
</dd>

<!--
<a name="opt_mail_ip_in_ns"></a>
<dt>-<span class="option">mail-ip-in-ns</span></dt>
<dd>
Reject if a sender's NS contains IP-in-name.
</dd>


<a name="opt_mail_ns_nxdomain"></a>
<dt>-<span class="option">mail-ns-nxdomain</span></dt>
<dd>
Reject if a sender's NS is in a non-existant domain.
</dd>
-->

<a name="opt_mail_bl"></a>
<dt><span class="option">mail-bl=</span><span class="value"></span></dt>
<dd>
A list of MD5 based MAIL BL suffixes to consult. Aggregate lists are
supported using suffix/mask. Without a /mask, suffix is the same as
suffix/0x00FFFFFE.
</dd>

<a name="opt_mail_bl_domains"></a>
<dt><span class="option">mail-bl-domains</span>=<span class="value">gmail.*</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">googlemail.*</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">hotmail.*</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">yahoo.*</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">aol.*</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">aim.*</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">live.*</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">ymail.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">rocketmail.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">centrum.cz</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">centrum.sk</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">inmail24.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">libero.it</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">mail2world.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">msn.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">she.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">shuf.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">sify.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">terra.es</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">tiscali.it</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">ubbi.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">virgilio.it</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">voila.fr</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">walla.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">y7mail.com</span></dt>
<dt><span class="option">mail-bl-domains</span>+=<span class="value">yeah.net</span></dt>
<dd>
A list of domain glob-like patterns for which to test against mail-bl,
typically free mail services. This reduces the load on public BLs.
Specify * to test all domains, empty list to disable.
</dd>

<a name="opt_mail_bl_headers"></a>
<dt><span class="option">mail-bl-headers=</span><span class="value">From;Reply-To</span></dt>
<dd>
A list of mail headers to parse for mail addresses and check against
one or more MAIL BL. Specify the empty list to disable.
</dd>

<a name="opt_mail_bl_max"></a>
<dt><span class="option">mail-bl-max=</span><span class="value">10</span></dt>
<dd>
Maximum number of unique mail addresses to check. Specify zero for
unlimited.
</dd>

<a name="opt_mail_bl_policy"></a>
<dt><span class="option">mail-bl-policy=</span><span class="value">reject</span></dt>
<dd>
If the message contains a black listed mail address found by mail-bl
the apply one of the following policies: none, reject, or discard.
</dd>


<a name="opt_mail_require_mx"></a>
<dt>+<span class="option">mail-require-mx</span></dt>
<dd>
Reject if the sender's domain has no MX record.
</dd>

<a name="opt_mail_retest_client"></a>
<dt>-<span class="option">mail-retest-client</span></dt>
<dd>
If set, recheck the client IP every message transaction. A client's
IP could be black listed locally or by a DNS BL during a message
transaction and would be caught starting with the next transaction.
</dd>

<a name="opt_message_length_controls"></a>
<dt><span class="option">Message Length Controls</span></dt>
<dd>
The tags <span class="tag">Length-Connect:</span>, <span class="tag">Length-From:</span>, and <span class="tag">Length-To:</span> can be used
in the <a href="#opt_access_map">access-map</a>.
<p>
If a key is found, then the value is processed as a pattern list
and the result returned. A size limit is specified in place of an
action, and is the maximum number of octets permitted per message.
it is expressed as a number with an optional scale suffix K (kilo),
M (mega), or G (giga). If no size limit is given or is -1, then
the message can be any length (ULONG_MAX).
</p>
<p>
When there are multiple message size limits possible, then the
limit applied, in order of precedence is: maximum value of all
relevant <span class="tag">Length-To:</span>, <span class="tag">Length-From:</span>, or <span class="tag">Length-Connect:</span>.
</p>
</dd>

<a name="opt_message_limit_controls"></a>
<dt><span class="option">Message Limit Controls</span></dt>
<dd>
The tags <span class="tag">Msg-Limit-Connect:</span>, <span class="tag">Msg-Limit-From:</span>, and <span class="tag">Msg-Limit-To:</span>
can be used in the <a href="#opt_access_map">access-map</a>.
<p>
If a key is found, then the value is processed as a pattern list
and the result returned. A message limit is specified in place of
an action and has the following format:
</p>
<blockquote><pre>
messages '/' time [unit]
</pre></blockquote>
<p>
which is the number of messages per time interval. The time unit
specifier can be one of week, day, hour, minute, or seconds (note
only the first letter is significant). Specify a negative number
for messages to disable a limit.
</p>
<p>
When there are multiple message limits possible, then the limit
applied, in order of precedence is:
<span class="tag">Msg-Limit-To:</span>,
<span class="tag">Msg-Limit-From:</span>,
and <span class="tag">Msg-Limit-Connect</span>.
</p>
</dd>

<a name="opt_ns_bl"></a>
<dt><span class="option">ns-bl</span>=<span class="value"></span></dt>
<dd>
A list of name based NS BL suffixes to consult. Aggregate lists are
supported using suffix/mask. Without a /mask, suffix is the same as
suffix/0x00FFFFFE.
</dd>

<a name="opt_ns_a_bl"></a>
<dt><span class="option">ns-a-bl</span>=<span class="value"></span></dt>
<dd>
A comma or semi-colon separated list of IP black list suffixes to consult.
The host or domain name found in a URI is used to find its DNS NS records
and IP address, which are then checked against these IP black lists.
Aggregate lists are supported using <code class="param">suffix/mask</code>.
Without a <code class="param">/mask</code>, suffix
is the same as <code class="param">suffix/0x00FFFFFE</code>.
</dd>



<a name="opt_null_sender_rate_control"></a>
<dt><span class="option">Null Sender Rate Control</span></dt>
<dd>
The tag <span class="tag">Null-Rate-To:</span> can be used in the access-map.
If a key is found, then the value is processed as a pattern list
and the result returned. An integer, in place of an action word,
specifies the number of DSN/MDN messages per minute allowed. Specify
-1 to disable the limit.
</dd>

<a name="opt_one-rcpt-per-null"></a>
<dt>+<span class="option">one-rcpt-per-null</span></dt>
<dd>
When the sender is MAIL FROM:&lt;&gt;, then there can only be one
RCPT TO: specified since the null address is only used to return
a Delivery Status Notification or Message Disposition Notification
to the original sender and it is not possible to have two or more
sender's for one message (in theory).
</dd>

<a name="opt_p0f_mutex"></a>
<dt>-<span class="option">p0f-mutex</span></dt>
<dd>
The p0f daemon is a single threaded process, but supposedly
fast enough not to require threading or mutex locking. When
enabled, a mutex is used to control access to the p0f daemon.
(Experimental)
</dd>

<a name="opt_p0f_report_header"></a>
<dt><span class="option">p0f-report-header</span>=<span class="value">X-p0f-Report</span></dt>
<dd>
The name of the p0f report header. Empty string to disable.
</dd>

<a name="opt_p0f_socket"></a>
<dt><span class="option">p0f-socket</span>=<span class="value"></span></dt>
<dd>
When set to the unix domain socket path of the p0f (passive OS finger-printing)
server, typically <code>/var/run/p0f.socket</code>, then an
<code>X-p0f-Report:</code> header is added to each message containing details
about the SMTP client connection. <span class="note">The p0f socket may
have to set to world read-writable in order for @PACKAGE_NAME@ to be able
to connect.</span> Specify the empty string to disable.
</dd>

<a name="opt_p0f_timeout"></a>
<dt><span class="option">p0f-timeout</span>=<span class="value">60</span></dt>
<dd>
The p0f I/O timeout in seconds.
</dd>

<a name="opt_quit"></a>
<dt>&plusmn;<span class="option">quit</span></dt>
<dd>
Quit an already running instance and exit.
</dd>

<a name="opt_quit"></a>
<dt>+<span class="option">rate-drop</span></dt>
<dd>
When a client exceeds per-client rate connection limits, send a 421
reply and if this option is set, drop the connection, otherwise wait
for the client to send the QUIT command.
</dd>

<a name="opt_rate_throttle"></a>
<dt><span class="option">rate-throttle</span>=<span class="value">20</span></dt>
<dd>
Overall client connections per second allowed before imposing a
one second delay. Specify zero (0) to disable.
</dd>

<a name="opt_reject_percent_relay"></a>
<dt>+<span class="option">reject-percent-relay</span></dt>
<dd>
Reject occurrences of % relay hack in addresses.
</dd>

<a name="opt_reject_quoted_at_sign"></a>
<dt>+<span class="option">reject-quoted-at-sign</span></dt>
<dd>
Reject occurrences of quoted @-sign in the local-part of the address.
</dd>

<a name="opt_reject_unknown_tld"></a>
<dt>+<span class="option">reject-unknown-tld</span></dt>
<dd>
Reject top-level-domains not listed by IANA.
</dd>

<a name="opt_reject_uucp_route"></a>
<dt>+<span class="option">reject-uucp-route</span></dt>
<dd>
Reject UUCP !-path addresses.
</dd>

<a name="opt_relay_reply"></a>
<dt>-<span class="option">relay-reply</span></dt>
<dd>
Relay downstream MTA error responses during RCPT TO: processing to
connected clients. Enabling this option might disclose information
about internal network structure, present incomplete or out of
context errors, have inconsistent message styles from multiple MTAs,
and generally appear more confusing than helpful to the connecting
client.
</dd>

<a name="opt_restart"></a>
<dt>&plusmn;<span class="option">restart</span></dt>
<dd>
Terminate an already running instance before starting.
</dd>

<a name="opt_restart_if"></a>
<dt>&plusmn;<span class="option">restart-if</span></dt>
<dd>
Only restart when there is a currently running instance.
</dd>

<a name="opt_rfc1652_8bitmime"></a>
<dt>-<span class="option">rfc1652-8bitmime</span></dt>
<dd>
Enables support for RFC 1652 8BITMIME transfers when the client sends
EHLO. Note that the support for this is weak, pass through only. If
enabled, then all forward hosts must also advertise 8BITMIME, otherwise
the behaviour is undefined.
See also <a href="#opt_smtp_enable_esmtp">smtp-enable-esmtp</a>.
</dd>

<a name="opt_rfc2606_special_domains"></a>
<dt>+<span class="option">rfc2606-special-domains</span></dt>
<dd>
When set, use of RFC 2606 reserved domains from the Internet or
in mail addresses is rejected. They are the TLDs .test, .example,
.invalid, .localhost, and the second level domain .example using
any TLD. While not part of RFC 2606, .localdomain and .local are
also included. Clients within the LAN and relays are excluded.
</dd>

<a name="opt_rfc2821_angle_brackets"></a>
<dt>+<span class="option">rfc2821-angle-brackets</span></dt>
<dd>
Strict RFC 2821 grammar requirement for mail addresses be surrounded
by angle brackets in MAIL FROM: and RCPT TO: commands.
</dd>

<a name="opt_rfc2821_command_length"></a>
<dt>-<span class="option">rfc2821-command-length</span></dt>
<dd>
Strict RFC 2821 command line length limit.
</dd>

<a name="opt_rfc2821_domain_length"></a>
<dt>-<span class="option">rfc2821-domain-length</span></dt>
<dd>
Strict RFC 2821 domain name length limit.
</dd>

<a name="opt_rfc2821_extra_spaces"></a>
<dt>-<span class="option">rfc2821-extra-spaces</span></dt>
<dd>
Strict RFC 2821 grammar requirement that SMTP commands not contain any
supurious white spaces.
</dd>

<a name="opt_rfc2821_line_length"></a>
<dt>-<span class="option">rfc2821-line-length</span></dt>
<dd>
Strict RFC 2821 data line length limit.
</dd>

<a name="opt_rfc2821_literal_plus"></a>
<dt>-<span class="option">rfc2821-literal-plus</span></dt>
<dd>
Treat plus-sign as itself; not a sendmail plussed address.
</dd>

<a name="opt_rfc2821_local_length"></a>
<dt>-<span class="option">rfc2821-local-length</span></dt>
<dd>
Strict RFC 2821 local-part length limit.
</dd>

<a name="opt_rfc2821_pad_reply_octet"></a>
<dt>-<span class="option">rfc2821-pad-reply-octet</span>=<span class="value"></span></dt>
<dd>
Specify a printable padding octet, then SMTP replies are padded out
to the maximum reply line length of 512 bytes as sepecified in RFC
2821 section 4.5.3.1. Specify an empty string to disable padding.
</dd>

<a name="opt_rfc2821_strict_dot"></a>
<dt>-<span class="option">rfc2821-strict-dot</span></dt>
<dd>
Strict RFC 2821 section 4.1.1.4 DATA handling of CRLF-DOT-CRLF sequence.
</dd>

<a name="opt_rfc2821_strict_helo"></a>
<dt>+<span class="option">rfc2821-strict-helo</span></dt>
<dd>
Strict RFC 2821 section 4.1.1.1 HELO argument must be a FQDN or
ip-domain literal.
</dd>

<a name="opt_rfc2822_7bit_headers"></a>
<dt>-<span class="option">rfc2822-7bit-headers</span></dt>
<dd>
Strict RFC 2822 7-bit ASCII printable message headers.
</dd>

<a name="opt_rfc2822_min_headers"></a>
<dt>-<span class="option">rfc2822-min-headers</span></dt>
<dd>
Require RFC 2822 minimum required headers.
</dd>

<a name="opt_rfc2822_strict_date"></a>
<dt>-<span class="option">rfc2822-strict-date</span></dt>
<dd>
Check Date, Resent-Date, and Received headers for strict RFC 2822
date syntax.
</dd>

<a name="opt_rfc2920_pipelining"></a>
<dt>+<span class="option">rfc2920-pipelining</span></dt>
<dd>
Enables support for RFC 2920 SMTP command pipelining when the client
sends EHLO. When there is early input before HELO/EHLO, HELO is used,
or EHLO PIPELINING has been disabled by this option, earlier talkers
are detected and rejected.
See also <a href="#opt_smtp_enable_esmtp">smtp-enable-esmtp</a>.
</dd>

<a name="opt_route_forward_selection"></a>
<dt><span class="option">route-forward-selection</span>=<span class="value">ordered</span></dt>
<dd>
The FORWARD host selection policy used when there is more than one
FORWARD host. Specify ordered or random. Ordered selection connects
to each host in turn until one answers or the list is exhausted.
Random selection will randomly connect to hosts from the list until
one answers or the list is exhausted.
</dd>

<a name="opt_route_map"></a>
<dt><span class="option">route-map</span>=<span class="value">sql!/etc/@PACKAGE_NAME@/route.sq3</span></dt>
<dd>
The type &amp; location of the route key-value map used for forwarding,
authentication, and recipient validation. The following methods are
supported:

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td width="60%" class="value tline">text!/path/map.txt</td><td width="40%" class="tline">R/O text file, in-memory hash</td></tr>
<tr><td width="60%" class="value">sql!/path/database</td><td width="40%">An SQLite3 database</td></tr>
<tr><td width="60%" class="value">socketmap!host:port</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="value">socketmap!/path/local/socket</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="value">socketmap!123.45.67.89:port</td><td width="40%">Sendmail style socket-map</td></tr>
<tr><td width="60%" class="value bline">socketmap![2001:0DB8::1234]:port</td><td width="40%" class="bline">Sendmail style socket-map</td></tr>
</table>
</blockquote>

<p>
If port is omitted, the default is 7953.
</p>
<p>
The <span class="option">route-map</span> contains key-value pairs. Lookups are performed
from most to least specific, stopping on the first entry found.
Keys are case-insensitive. Lookups are the same as for <a href="#opt_access_map">access-map</a>
using a route: tag and can include recipient mail address lookups.
</p>
<p>
If a key is found, then the value is a semicolon separated list of
one or more parameters. The three types of parameters are:
</p>
<blockquote>
<table width="100%">
<tr><td width="30%">RELAY</td><td>connecting clients can relay</td></tr>
<tr><td>RCPT: host:port ...</td><td>recipient verification list</td></tr>
<tr><td>FORWARD: host:port ...</td><td>accept &amp; forward mail list</td></tr>
</table>
</blockquote>
<p>
If the :port is omitted from a host name or IP address, then the
default is SMTP port 25. The hosts are tried in the order they
were specified. Some examples:
</p>
<blockquote>
<table width="100%">
<tr><td width="30%">route:127.0.0.1</td><td>FORWARD: 127.0.0.1:26; RELAY</td></tr>
</table>
</blockquote>
<p>
Relay mail inbound and outbound for the local host. Unqualifed
recipients will be directed to here as well.
</p>
<blockquote>
<table width="100%">
<tr><td width="30%">route:192.0.2</td><td>RELAY</td></tr>
</table>
</blockquote>

<p>
Relay mail outbound for the LAN.
</p>
<blockquote>
<table width="100%">
<tr><td width="30%">route:example.com</td><td>FORWARD: mx.filter.net; RCPT: in.our.net</td></tr>
</table>
</blockquote>

<p>
Forward mail to another mail appliance, but call-ahead to
validate recipients deeper inside our network.
</p>
<blockquote>
<table width="100%">
<tr><td width="30%">route:other.example</td><td>RELAY; FORWARD: mx.other.example:8025</td></tr>
</table>
</blockquote>

<p>
Relay mail outbound from client connections that resolve to
other.example and forward mail destined for other.example to
to an MX listening on a different port.
</p>
<blockquote>
<table width="100%">
<tr><td width="30%">route:john@some.tld</td><td>FORWARD: mx1.baka.tld mx2.baka.tld</td></tr>
</table>
</blockquote>

Forward mail for this recipient address to one of these two hosts.
</dd>

<a name="opt_run_group"></a>
<dt><span class="option">run-group</span>=<span class="value">@PACKAGE_NAME@</span></dt>
<dd>
Run as this Unix group.
</dd>

<a name="opt_run_jailed"></a>
<dt>-<span class="option">run-jailed</span></dt>
<dd>
Run in a chroot jail; <a href="#opt_run_work_dir">run-work-dir</a> used as the new root directory.
</dd>

<a name="opt_run_open_file_limit"></a>
<dt><span class="option">run-open-file-limit</span>=<span class="value">1024</span></dt>
<dd>
The maximum open file limit for the process.
</dd>

<a name="opt_run_pid_file"></a>
<dt><span class="option">run-pid-file</span>=<span class="value">/var/run/@PACKAGE_NAME@.pid</span></dt>
<dd>
The file path of where to save the process-id.
</dd>

<a name="opt_run_user"></a>
<dt><span class="option">run-user</span>=<span class="value">@PACKAGE_NAME@</span></dt>
<dd>
Run as this Unix user.
</dd>

<a name="opt_run_work_dir"></a>
<dt><span class="option">run-work-dir</span>=<span class="value">/var/tmp</span></dt>
<dd>
The working directory of the process.
</dd>

<a name="opt_savdid_policy"></a>
<dt><span class="option">savdid-policy</span>=<span class="value">reject</span></dt>
<dd>
Policy to apply if message is infected. Specify either none,
reject, or discard.
</dd>

<a name="opt_savdid_socket"></a>
<dt><span class="option">savdid-socket</span>=<span class="value"></span></dt>
<dd>
The unix domain socket or Internet host[:port] of the savdid
server. Specify the empty string to disable savdid scan. The
default savdid port is 4010.
</dd>

<a name="opt_savdid_timeout"></a>
<dt><span class="option">savdid-timeout</span>=<span class="value">120</span></dt>
<dd>
The savdid I/O timeout in seconds.
</dd>

<a name="opt_save_data"></a>
<dt>-<span class="option">save-data</span></dt>
<dd>
When set, save the DATA content to a file in the save-dir directory.
Intended for testing and diagnosis.
</dd>

<a name="opt_save_dir"></a>
<dt><span class="option">save-dir</span>=<span class="value">/var/tmp</span></dt>
<dd>
A directory where to save temporary message files and/or output for diagnosis.
</dd>

<a name="opt_server_max_threads"></a>
<dt><span class="option">server-max-threads</span>=<span class="value">0</span></dt>
<dd>
Maximum number of server threads possible to handle new requests.
Specify zero to allow upto the system thread limit.
</dd>

<a name="opt_server_min_threads"></a>
<dt><span class="option">server-min-threads</span>=<span class="value">10</span></dt>
<dd>
Minimum number of server threads to keep alive to handle new requests.
</dd>

<a name="opt_server_new_threads"></a>
<dt><span class="option">server-new-threads</span>=<span class="value">10</span></dt>
<dd>
Number of new server threads to create when all the existing threads
are in use.
</dd>

<a name="opt_service"></a>
<dt>&plusmn;<span class="option">service</span></dt>
<dd>
Add or remove Windows service.
</dd>

<a name="opt_slow_quit"></a>
<dt>&plusmn;<span class="option">slow-quit</span></dt>
<dd>
Quit an already running instance, waiting for all the connections to
terminate, then exit.
</dd>

<a name="opt_siq_score_reject"></a>
<dt><span class="option">siq-score-reject</span>=<span class="value">-1</span></dt>
<dd>
Reject on or below this score, between 0 and 99; -1 to disable.
</dd>

<a name="opt_siq_score_tag"></a>
<dt><span class="option">siq-score-tag</span>=<span class="value">50</span></dt>
<dd>
Tag the subject on or below this score, between 0 and 99; -1 to disable.
</dd>

<a name="opt_siq_servers"></a>
<dt><span class="option">siq-servers</span>=<span class="value"></span></dt>
<dd>
Comma separated list of SIQ server host[:port] addresses.
<p>
This filter can tag or reject mail according to a score returned by a SIQ Protocol server
that grades IP/domain pairs based on the server's reputation criteria. Third-party SIQ
servers can provide facts about the reputation of an outbound mail server IP and/or
MAIL FROM: domain including: stability, longevity, identifiability, SPF match,
RHS type grouping, verified PTR record matching, et al. One such service is
already available from <a href="http://outboundindex.org/">Outbound Index</a>.
Please check with the service(s) available before using them as some require
registration before they will answer queries.
</p>
</dd>

<a name="opt_siq_subject_tag"></a>
<dt><span class="option">siq-subject-tag</span>=<span class="value">[SPAM]</span></dt>
<dd>
Subject tag to preprend for messages identified as suspect.
</dd>

<a name="opt_smtp_auth_enable"></a>
<dt>-<span class="option">smtp-auth-enable</span></dt>
<dd>
When set, enable SMTP AUTH support when EHLO command is given.
</dd>

<a name="opt_smtp_auth_white"></a>
<dt>-<span class="option">smtp-auth-white</span></dt>
<dd>
When set, successful SMTP authenticated sessions are white listed
through content filters. Otherwise, content filtering is applied.
Regardless of this setting, successful SMTP AUTH sessions are
always allowed to relay.
</dd>

<a name="opt_smtp_command_timeout"></a>
<dt><span class="option">smtp-command-timeout</span>=<span class="value">300</span></dt>
<dd>
SMTP command timeout in seconds.
</dd>

<a name="opt_smtp_connect_timeout"></a>
<dt><span class="option">smtp-connect-timeout</span>=<span class="value">60</span></dt>
<dd>
SMTP client connection timeout in seconds.
</dd>

<a name="opt_smtp_data_line_timeout"></a>
<dt><span class="option">smtp-data-line-timeout</span>=<span class="value">180</span></dt>
<dd>
SMTP data line timeout in seconds after DATA while collecting
message content.
</dd>

<a name="opt_smtp_delay_checks"></a>
<dt>-<span class="option">smtp-delay-checks</span></dt>
<dd>
Postpone any policy based 5xy rejections until after the first RCPT
has been specified. Temporary failures and rejections due to syntax
or protocol errors are still reported immediately. This allows
recipient white-listing to override policy rejections based on
connection, HELO, AUTH, or MAIL arguments.
</dd>

<a name="opt_smtp_disconnect_after_dot"></a>
<dt>-<span class="option">smtp-disconnect-after-dot</span></dt>
<dd>
If the SMTP client drops the connection after sending the dot for end
of message, but before the SMTP response is sent indicating whether the
message was accepted or not, then the message is discarded and our end
of the connection closed.
</dd>

<a name="opt_smtp_dot_timeout"></a>
<dt><span class="option">smtp-dot-timeout</span>=<span class="value">600</span></dt>
<dd>
Timeout in seconds to wait for a reply to the SMTP final dot sent
to the forward hosts.
</dd>

<a name="opt_smtp_drop_after"></a>
<dt><span class="option">smtp-drop-after</span>=<span class="value">5</span></dt>
<dd>
Drop the connection after N temporary and permanently rejected
commands, ie. count any 4xy or 5xy responses and eventually drop.
Zero to disable.
</dd>
<!--
<a name="opt_smtp_drop_rset"></a>
<dt>-<span class="option">smtp-drop-rset</span></dt>
<dd>
Drop the connection if client sends RSET.
</dd>
-->
<a name="opt_smtp_drop_unknown"></a>
<dt>-<span class="option">smtp-drop-unknown</span></dt>
<dd>
Drop the connection if client sends an unknown command.
To work around Cisco PIX firewalls broken fix-up protocol,
this option ignores any command that starts with 'XXX'.
</dd>

<a name="opt_smtp_dsn_reply_to"></a>
<dt><span class="option">smtp-dsn-reply-to</span>=<span class="value"></span></dt>
<dd>
When set this is the mail address of the site's postmaster or
help desk used for the Reply-To header in DSN error messages.
Specify the empty string to disable.
</dd>

<a name="opt_smtp_enable_esmtp"></a>
<dt>+<span class="option">smtp-enable-esmtp</span></dt>
<dd>
Enable enhanced SMTP (ESMTP) for all clients. When disabled any
hosts marked as RELAY in the route-map or from RFC 3330 private
IP addresses will be exempt and always allowed to use ESMTP
regardless.
</dd>

<a name="opt_smtp_keep_alive_timeout"></a>
<dt><span class="option">smtp-keep-alive-timeout</span>=<span class="value">60</span></dt>
<dd>
In some cases, the forwarding of the DATA command is delayed and so
we have to keep the forward connection(s) alive until they pass into
the DATA state. The timeout is specified in seconds; specify 0 to
disable the timeout.
</dd>

<a name="opt_smtp_reject_delay"></a>
<dt>-<span class="option">smtp-reject-delay</span></dt>
<dd>
When set, exponentially delay the reporting of SMTP temporary and
permanent rejects during the SMTP session. After enough rejects
the client connection will timeout and be dropped.
See also <a href="#opt_rfc2920_pipelining">rfc2920-pipelining</a>.
and <a href="#opt_smtp_drop_after">smtp-drop-after</a>.
</dd>

<a name="opt_smtp_reject_file"></a>
<dt><span class="option">smtp-reject-file</span>=<span class="value"></span></dt>
<dd>
The file path of a text file containing a site specific message
that will be appended to all SMTP reject responses. This text
should contain brief instructions for the sender about who to
contact for help. The text can be more than one line. Specify
the empty string to disable this message.
</dd>

<a name="opt_smtp_report_header"></a>
<dt><span class="option">smtp-report-header</span>=<span class="value">X-smtpf-Report</span></dt>
<dd>
The name of the smtpf report header. Empty string to disable.
</dd>

<a name="opt_smtp_server_queue"></a>
<dt><span class="option">smtp-server-queue</span>=<span class="value">20</span></dt>
<dd>
SMTP server connection queue size. This setting is OS specific and
tells the kernel how many unanswered connections on the socket it
should allow.
</dd>

<a name="opt_smtp_slow_reply"></a>
<dt>-<span class="option">smtp-slow-reply</span></dt>
<dd>
Impose an throttling delay for all SMTP server replies. This option
will most likely result in increased concurrency, which is normal.
</dd>

<a name="opt_smtp_strict_relay"></a>
<dt>-<span class="option">smtp-strict-relay</span></dt>
<dd>
Only allow outbound messages from our specified relays and where
the sender is from one of our routed domains (see <a href="#opt_route_map">route-map</a>).
</dd>

<a name="opt_smtp_welcome_file"></a>
<dt><span class="option">smtp-welcome-file</span>=<span class="value">/etc/@PACKAGE_NAME@/welcome.txt</span></dt>
<dd>
The file path to a text file containing one or more lines used
for the SMTP welcome message banner. The 220 status code will be
automatically prepended to each line. It is recommended that this
message be two or more lines as this has been found to foil some
spamware. If an empty string is given, a hard coded default will
be used.
</dd>

<a name="opt_spamd_command"></a>
<dt><span class="option">spamd-command</span>=<span class="value">CHECK</span></dt>
<dd>
Specify one of the SPAMD protocol commands: CHECK, SYMBOLS, REPORT,
REPORT_IFSPAM to check the message. When used in conjunction with
verbose=spamd, more detailed results from spamd will be logged.
</dd>

<a name="opt_spamd_flag_header"></a>
<dt><span class="option">spamd-flag-header</span>=<span class="value">X-Spam-Flag</span></dt>
<dd>
The name of the flag header. Empty string to disable.
</dd>

<a name="opt_spamd_level_header"></a>
<dt><span class="option">spamd-level-header</span>=<span class="value">X-Spam-Level</span></dt>
<dd>
The name of the level header. Empty string to disable.
</dd>

<a name="opt_spamd_max_size"></a>
<dt><span class="option">spamd-max-size</span>=<span class="value">0</span></dt>
<dd>
Max. number of kilobytes to pass to spamd, 0 for unlimited.
</dd>

<a name="opt_spamd_reject_sender_marked_spam"></a>
<dt>+<span class="option">spamd-reject-sender-marked-spam</span></dt>
<dd>
When an <code>X-Spam-Status</code> header is supplied by the sender, then check their
claimed score against spamd-score-reject and reject if they exceed it.
Else if an <code>"X-Spam-Flag: YES"</code> header is supplied by the sender, then
reject the message. If the sender thought it was spam, why would we want
it? Otherwise the message will be scanned and scored as per usual.
</dd>

<a name="opt_spamd_report_header"></a>
<dt><span class="option">spamd-report-header</span>=<span class="value">X-Spam-Report</span></dt>
<dd>
The name of the report header. Empty string to disable.
</dd>

<a name="opt_spamd_score_reject"></a>
<dt><span class="option">spamd-score-reject</span>=<span class="value">10</span></dt>
<dd>
When spamd returns a score greater than or equal to this value
then the message will be rejected. Specify -1 to never reject.
</dd>

<a name="opt_spamd_socket"></a>
<dt><span class="option">spamd-socket</span>=<span class="value"></span></dt>
<dd>
The unix domain socket or Internet host[:port] of the spamd
server. Specify the empty string to disable spamd scan. The
default spamd port is 783.
</dd>

<a name="opt_spamd_status_header"></a>
<dt><span class="option">spamd-status-header</span>=<span class="value">X-Spam-Status</span></dt>
<dd>
The name of the status header. Empty string to disable.
</dd>

<a name="opt_spamd_subject_tag"></a>
<dt><span class="option">spamd-subject-tag</span>=<span class="value">[SPAM]</span></dt>
<dd>
When the score is greater than or equal to SpamAssassin's <code>required_score</code>
and less than spamd-score-reject (when not disabled), then the Subject
header is prepended with this tag to identify suspect messages. Specify
the empty string to disable the subject tag.
</dd>

<a name="opt_spamd_timeout"></a>
<dt><span class="option">spamd-timeout</span>=<span class="value">120</span></dt>
<dd>
The spamd I/O timeout in seconds.
</dd>

<a name="opt_spf_best_guess_txt"></a>
<dt><span class="option">spf-best-guess-txt</span>=<span class="value"></span></dt>
<dd>
If the initial SPF test does not yield a Pass for any reason, then
we check this "best guess" TXT record (eg. v=spf1 a/24 mx/24 ptr)
to see if it yields a Pass result. Otherwise use the original SPF
result.
</dd>

<a name="opt_spf_helo_policy"></a>
<dt><span class="option">spf-helo-policy</span>=<span class="value"></span></dt>
<dd>
Check HELO argument and act according to a comma separated list:
softfail-reject, softfail-tag, fail-reject, fail-tag

Example: spf-helo-policy=fail-reject
</dd>

<a name="opt_spf_mail_policy"></a>
<dt><span class="option">spf-mail-policy</span>=<span class="value">fail-reject</span></dt>
<dd>
Check MAIL FROM: domain and act according to a comma separated list:
softfail-reject, softfail-tag, fail-reject, fail-tag

Example: spf-mail-policy=softfail-reject,fail-reject
</dd>

<a name="opt_spf_received_spf_headers"></a>
<dt>+<span class="option">spf-received-spf-headers</span></dt>
<dd>
Add Received-SPF: headers with results of HELO and MAIL FROM: checks.
</dd>

<a name="opt_spf_temp_error_dns"></a>
<dt>+<span class="option">spf-temp-error-dns</span></dt>
<dd>
RFC 4408 specifies that DNS lookup failures should return a TempError
result. However, there are many broken SPF records that rely on other
domains that may no longer exist or have connectity problems. Disabling
this option allows such failures to be ignored and the remainder of the
SPF record to be processed in hopes of finding a result.
</dd>

<a name="opt_stats_http_pass"></a>
<dt><span class="option">stats-http-pass</span>=<span class="value"></span></dt>
<dd>
HTTP password for restricted access.
</dd>

<a name="opt_stats_http_post"></a>
<dt><span class="option">stats-http-post</span>=<span class="value"></span></dt>
<dd>
Specify an HTTP URL used to gather statistic data each garabage
collection run. Specify the empty string to disable. The data sent
has the same format as the STAT command output. Runtime, hourly, and
60 minute window data including route stats are all sent.
</dd>

<a name="opt_stats_http_user"></a>
<dt><span class="option">stats-http-user</span>=<span class="value"></span></dt>
<dd>
HTTP user name for restricted access.
</dd>

<a name="opt_stats_map"></a>
<dt><span class="option">stats-map</span>=<span class="value">sql!/var/db/@PACKAGE_NAME@/stats.sq3</span></dt>
<dd>
This option specifies the cache type and path used to record
hourly statistic counters. Specify the empty string to disable.
This file is updated according to the cache-gc-interval. Note
that it is the responsibility of the data gatherer process to expire
old entries from this file, otherwise it will grow indefinitely.
<p>
The following map methods are supported:
</p>

<blockquote>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td width="50%" class="value tline">file!/path/map.txt</td><td width="50%" class="tline">R/W Berstein string file, in-memory hash</td></tr>
<tr><td width="50%" class="value">text!/path/map.txt</td><td width="50%">R/O text file, in-memory hash</td></tr>
<tr><td width="50%" class="value">sql!/path/database</td><td width="50%">An SQLite3 database</td></tr>
<tr><td width="50%" class="value">socketmap!host:port</td><td width="50%">Sendmail style socket-map</td></tr>
<tr><td width="50%" class="value">socketmap!/path/local/socket</td><td width="50%">Sendmail style socket-map</td></tr>
<tr><td width="50%" class="value">socketmap!123.45.67.89:port</td><td width="50%">Sendmail style socket-map</td></tr>
<tr><td width="50%" class="value bline">socketmap![2001:0DB8::1234]:port</td><td width="50%" class="bline">Sendmail style socket-map</td></tr>
</table>
</blockquote>

<p>
If port is omitted, the default is 7953.
</p>
<p>
The <span class="option">stats-map</span> contains key-value pairs. The key is the current
hour specified as "YYYYMMDDHH" and the value is a white space
separated list of hex values, the first two being the process
start time in seconds from the epoch and the last update time
in seconds from the epoch followed by the counters (see STAT).
</p>
</dd>

<a name="opt_time_limit_delimiters"></a>
<dt><span class="option">time-limit-delimiters</span>=<span class="value"></span></dt>
<dd>
A string of characters that can be used to indicate a time limit
field in the local part of a recipient address. Specify the empty
string to disable. Characters that can be used are defined in RFC
5322 "atext". They are:
<blockquote><pre>
! # $ % & ' * + - / = ? ^ _ ` { | } ~ .
</pre></blockquote>
<p>
Note that dot (.) is fairly common and should not be used. Also
sendmail and postfix treat plus (+) and hyphen (-) specially and
are not recommended. Percent (%) was used for an old routing synatx,
which may be rejected by sites and not recommeded.
</p>
</p>
The delimiter indicates the start of a time limit field, which is
an optional non-numeric informational token followed by a series of
4 to 12 decimal digits. The digits represents "YYYY[MM[DD[hh[mm]]]]"
of the expire time when this recipient address is no longer valid
and will be rejected. The delimiter and time limit field can appear
any where in the user portion of the address and are removed before
forwarding the receipient.
</p>
<p>
Examples using the address &lt;john.smith@domain.example&gt; and delimiter
dollar-sign ($):
</p>
<blockquote><pre>
&lt;john.smith$20080401@domain.example&gt;
&lt;$token_word20080401john.smith@domain.example&gt;
&lt;john$mail.list.name20080401.smith@domain.example&gt;
</pre></blockquote>
</dd>

<a name="opt_tld_level_one_file"></a>
<dt><span class="option">tld-level-one-file</span>=<span class="value"></span></dt>
<dd>
The absolute file path of a text file, containing white space
separated list of global and country top level domains (without
any leading dot), eg. biz com info net org eu fr uk. This list
will override the built-in list.
</dd>

<a name="opt_tld_level_two_file"></a>
<dt><span class="option">tld-level-two-file</span>=<span class="value"></span></dt>
<dd>
The absolute file path of a text file, containing white space
separated list of two-level domains (without any leading dot),
eg. co.uk ac.uk com.au gouv.fr tm.fr. This list will override
the built-in list.
</dd>

<a name="opt_trap_dir"></a>
<dt><span class="option">trap-dir</span>=<span class="value">/var/tmp</span></dt>
<dd>
A directory where to save temporary message files and/or output marked by TRAP
action for diagnosis.
</dd>

<a name="opt_uri_bl"></a>
<dt><span class="option">uri-bl</span>=<span class="value"></span></dt>
<dd>
Extract from text, HTML, and/or MIME encoded messages bodies URIs
such as http: and mailto: links, then check one or more URI black
lists. Give a list of domain based DNS BL suffixes to consult, like
<code>.multi.surbl.org</code>. Aggregate lists are supported using <code>suffix/mask</code>.
Without a <code>/mask</code>, suffix is the same as <code>suffix/0x00FFFFFE</code>.
<p>
The tag <span class="tag">Body:</span> can be used in the <a href="#opt_access_map">access-map</a> to white-list domains
found within the message, for example <code>w3c.org</code> or <code>google.com</code>.
</p></dd>

<a name="opt_uri_bl_headers"></a>
<dt><span class="option">uri-bl-headers</span>=<span class="value"></span></dt>
<dd>
A semi-colon separated list of mail headers to parse for URI and check against one or
more URI BL. Specify the empty list to disable.
</dd>

<a name="opt_uri_bl_helo"></a>
<dt>-<span class="option">uri-bl-helo</span></dt>
<dd>
Check if the HELO/EHLO argument is black listed using uri-dns-bl
and/or uri-bl.
</dd>

<a name="opt_uri_bl_mail"></a>
<dt>-<span class="option">uri-bl-mail</span></dt>
<dd>
Check if the domain of the MAIL FROM: argument is black listed
using uri-dns-bl and/or uri-bl.
</dd>

<a name="opt_uri_bl_policy"></a>
<dt><span class="option">uri-bl-policy</span>=<span class="value">reject</span></dt>
<dd>
Check if the message contains a black listed URI found by uri-bl
or uri-dns-bl. Specify one of none, reject, or discard. When set
to none, the test is disabled.
</dd>

<a name="opt_uri_bl_ptr"></a>
<dt>-<span class="option">uri-bl-ptr</span></dt>
<dd>
Check if the PTR result is black listed using uri-dns-bl and/or
uri-bl.
</dd>

<a name="opt_uri_cite_list"></a>
<dt>+<span class="option">uri-cite-list</span></dt>
<dd>
When enabled, URI BL based rejection will cite the black list used.
</dd>

<a name="opt_uri_dns_bl"></a>
<dt><span class="option">uri-dns-bl</span>=<span class="value"></span></dt>
<dd>
Extract from text, HTML, and/or MIME encoded messages bodies URIs
such as http: and mailto: links, then consult one or more IP black
lists. Give a list of IP based DNS BL suffixes to consult, like
sbl-xbl.spamhaus.org. Aggregate lists are supported using suffix/mask.
Without a /mask, suffix is the same as suffix/0x00FFFFFE.

<p>
The tag <span class="tag">Body:</span> can be used in the <a href="#opt_access_map">access-map</a> to white-list domains
found within the message, for example w3c.org or google.com.
</p>
</dd>

<a name="opt_uri_ip_in_name"></a>
<dt>-<span class="option">uri-ip-in-name</span></dt>
<dd>
For each URI, apply a pattern heuristic to the host's name and reject
if it looks like it is composed from it's IP address.
</dd>

<a name="opt_uri_ip_in_ns"></a>
<dt>-<span class="option">uri-ip-in-ns</span></dt>
<dd>
For each URI, apply a pattern heuristic to the host's NS server names
and reject if any look like they are composed from their IP addresses.
</dd>

<!--
<a name="opt_uri_ip_in_ptr"></a>
<dt><span class="option">uri-ip-in-ptr</span>=<span class="value">0</span></dt>
<dd>
For each URI, lookup the host's IP addresses followed by each IP's
PTR record. Apply a pattern heuristic to each PTR record and reject
if it looks like the PTR is composed from the IP address. Specify the
minimum number of IP addresses a host must have before applying this
test; zero to disable.
</dd>
-->

<a name="opt_uri_links_policy"></a>
<dt><span class="option">uri-links-policy</span>=<span class="value">none</span></dt>
<dd>
Test if message contains a broken URL and apply policy if found.
Specify one of none, reject, or discard. When set to none, the test
is disabled.
</dd>

<!--
<a name="opt_uri_max_limit"></a>
<dt><span class="option">uri-max-limit</span>=<span class="value">0</span></dt>
<dd>
Maximum number of URI that a message may contain before being
rejected. Intended as a means to prevent DoS attacks that attempt to
flood the URI filter and/or the DNS server with excessive lookups.
Specify zero for unlimited.
</dd>
-->

<a name="opt_uri_max_test"></a>
<dt><span class="option">uri-max-test</span>=<span class="value">10</span></dt>
<dd>
Maximum number of unique URI to check. Specify zero for unlimited.
</dd>

<a name="opt_uri_ns_nxdomain"></a>
<dt>-<span class="option">uri-ns-nxdomain</span></dt>
<dd>
Reject if a URI's NS host is in a non-existant domain.
</dd>

<a name="opt_uri_reject_on_timeout"></a>
<dt>-<span class="option">uri-reject-on-timeout</span></dt>
<dd>
Reject any URI host/domain that times out while looking up DNS A records.
</dd>

<a name="opt_uri_reject_unknown"></a>
<dt>-<span class="option">uri-reject-unknown</span></dt>
<dd>
Reject any URI host/domain that does not exist.
</dd>

<a name="opt_uri_require_domain"></a>
<dt>-<span class="option">uri-require-domain</span></dt>
<dd>
Reject URLs that specify a scheme and refer to a bare IP address.
</dd>

<a name="opt_uri_require_ptr"></a>
<dt><span class="option">uri-require-ptr</span>=<span class="value">0</span></dt>
<dd>
Reject any URI where the host name is missing a PTR record for any
of its IP addresses. Specify the minimum number of IP addresses a
host must have before applying this test; zero to disable.
</dd>

<a name="opt_uri_sub_domains"></a>
<dt>-<span class="option">uri-sub-domains</span></dt>
<dd>
When querying against name based black lists, like .multi.surbl.org
or .black.uribl.com, first test the registered domain, then any
sub-domains from right-to-left. Typically sub-domains are not listed
on URI black lists.
</dd>

<a name="opt_uri_valid_soa"></a>
<dt>-<span class="option">uri-valid-soa</span></dt>
<dd>
For each URI found, check that the domain has a valid SOA and reject otherwise.
</dd>

<a name="opt_verbose"></a>
<dt><span class="option">verbose</span>=<span class="value">warn,info</span></dt>
<dd>
Verbose logging to system mail log. Specify one or more comma separated words:
access attachment auth avastd cache clamd connect data db debug
digest dns dupmsg emew fpscand grey headers helo info kvm mail mutex noop
p0f rate rbl rcpt rset sav savdid save size smtp smtp-data smtp-dot
socket-fd spamd spf stats subject timelimitrcpt timers trace uri warn
</dd>

</dl>

<p style="text-align: center;">
-<a href="#"> TOP </a>-
</p>

<p class="copyright" style="text-align: center;">
<nobr>@package_copyright@</nobr>
<br/><nobr>BarricadeMX trademark &amp; patents pending.</nobr>
</p>

</td></tr>
</table>
</div>
</body>
</html>
