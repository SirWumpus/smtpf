<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>

<title> - F-PROT Antivirus Support</title>
<meta name="Robots" content="index, follow">
<meta name="Robots" content="index, follow">
<meta name="KEYWORDS" content="virus, antivirus, anti-virus">
<meta name="DESCRIPTION" content="Frisk Software International, the makers of F-Prot Antivirus and F-Prot AVES">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<link rel="alternate" type="application/rss+xml" title="FRISK - General News" href="http://www.f-prot.com/rss/frisk-news.xml"><!--
<link rel="alternate" type="application/rss+xml" title="FRISK - Security News" href="http://www.f-prot.com/rss/frisk-sec.xml">
<link rel="alternate" type="application/rss+xml" title="FRISK - Virus Descriptions" href="http://www.f-prot.com/rss/virdesc.xml">  -->

<link style="visibility: visible ! important;" rel="SHORTCUT ICON" href="http://www.f-prot.com/favicon.ico">
	<link type="text/css" rel="stylesheet" href="appendix_a_files/reset-fonts-grids.css">
	<link type="text/css" rel="stylesheet" href="appendix_a_files/newstyles.css">
	<link type="text/css" rel="stylesheet" href="appendix_a_files/stylish.css">
<link media="print" type="text/css" rel="stylesheet" href="appendix_a_files/printnew.css">
<!-- Google Analytics script code begins -->

<script style="visibility: visible ! important;" src="appendix_a_files/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-71015-1";
_udn="f-prot.com"; 
urchinTracker();
</script>

<!-- Google Analytics script code ends -->
<style>
#navigation ul {
list-style-type:none;
margin:0px;
padding:0px;
padding-bottom: 2px;
}
#navsearch {
display: inline;
padding: 0px;
margin: 0px;
}
#navigation li {
float:none;
padding: 0px;
margin: 0px;
}
#navigation {
margin: 0px;
margin-top:0px;
padding-left: 0.5em;
}

#navigation a {
margin: 0px;
padding: 0px;
text-decoration:none;
font-size:12px;
padding:5px;line-height:28px;
}
#navigation ul form {
margin:0px;
padding:0px;
display: inline;
}
#searchbutton {
background-color:#F2F2F2;
background-image:url(http://www.f-prot.com/img/search.gif);
background-position:center left;
background-repeat:no-repeat;
border-color:#335C85;
border-style:solid;
color:#003366;
font-family:Helvetica,Geneva,SunSans-Regular,sans-serif;
font-size:10px;
font-weight:bold;
padding:3px;
padding-left: 15px;
text-decoration:none;
margin: 0px;
}
#searchspace {
background-color:#F2F2F2;
border-color:#335C85;
border-style:solid;
border-width:1px;
color:#003366;
font-size:12px;
padding: 2px;
margin: 0px;
}

 #searchspace:focus {
background-color:#F2F2F2;
border-color:#cc3300;
border-style:solid;
border-width:1px;
color:#003366;
}  
</style>
<style type="text/css">
#chm_header, #chm_navigation, #copyright {
display: none !important;
}
.head_blueboldfont {
font-size:20px;
font-weight: bold;
}
</style>
<title>How to interface with fpscand</title></head><body id="fprot">
<div id="fdoc" class="yui-t7"><!-- "doc" here for example only; use any page width -->			
	<div id="hd">

		 <!-- banner starts -->
		 	<div id="friskbanner">
  				<h1><a href="http://www.f-prot.com/index.html"><img style="visibility: visible ! important;" src="appendix_a_files/frisk_logo.gif" alt="FRISK Software International"></a></h1>

  			</div>
  		
  		<!-- banner ends -->
  		<!-- navigation starts -->
  		
  			<div id="navigation">
  				<ul>
    				<li><a href="https://secure.f-prot.com/cgi-bin/buy">Order</a></li>
    				<li><a href="http://www.f-prot.com/products/">Products</a></li>

    				<li><a href="http://www.f-prot.com/download/">Download</a></li>
    				<li><a href="http://www.f-prot.com/support/">Support</a></li>
    				<li><a href="http://www.f-prot.com/virusinfo">Virus Information</a></li>
    				<li><a href="http://www.f-prot.com/partners/">Partners</a></li>
    				<li><a href="http://www.f-prot.com/company/">About</a></li>
    				<li><a href="http://www.f-prot.com/news/">News</a></li>
    				<li><a href="http://forum.f-prot.com/">Forum</a></li>

    				<li><a href="http://www.f-prot.com/rss_info.html">Feeds</a></li>
<li><form method="get" name="gs" action="http://search.f-prot.com/search" id="navsearch">
        <input name="q" id="searchspace" size="25" maxlength="255" type="text">
<input name="btnG" value="Search" id="searchbutton" type="submit">
        <input name="site" value="fprot" type="hidden">
        <input name="client" value="default_frontend" type="hidden">
        <input name="proxystylesheet" value="default_frontend" type="hidden">

        <input name="output" value="xml_no_dtd" type="hidden">
</form></li>
  				</ul>
					

			</div>
		
		<!-- navigation ends -->
	</div>
	<div id="bd">
		<div id="yui-main">
			<div class="yui-b">
        <div id="subheader">
						<p class="breadcrumbs">

												<a href="http://www.f-prot.com/support/helpfiles/unix/support/index.html">Support and Service</a> &gt;
																		<a href="">F-PROT Antivirus for UNIX</a> &gt;
																		
						

<!-- <a class="nav" href="http://www.f-prot.com/">Front Page</a> &gt; -->
            </p>
				</div>
      
      

			</div>
		</div>
            <!-- Top level ends, content begins -->
		<div class="yui-b" style="margin: 0px; padding: 0px 0px 0px 1em;">
    
    <div class="yui-gc">
						
<!-- Support Content unit -->
			<div class="yui-u first fsupport">








<link rel="stylesheet" type="text/css" href="appendix_a_files/chmstyle.htm">
 



<div id="chm_header"><img style="visibility: visible ! important;" src="appendix_a_files/banner.htm"></div>

<div id="chm_navigation">
	<a href="http://www.f-prot.com/support/helpfiles/unix/fpupdate_options.html"><img style="visibility: visible ! important;" src="appendix_a_files/arrow_left.htm" border="0" hspace="5"></a> 
	<a href="http://www.f-prot.com/support/helpfiles/unix/appendix_b.html"><img style="visibility: visible ! important;" src="appendix_a_files/arrow_right.htm" border="0"></a>
</div>

<div id="chm_title">
	<span class="head_blueboldfont">7.1 How to interface with fpscand</span>
</div>
<div id="chm_content">
&nbsp;

<p><i>This section applies to F-PROT Antivirus for UNIX File Server and Mail Server versions only</i></p>

<p>This section describes best practices for 3rd party applications to interface 
with the F-PROT Antivirus Daemon Scanner to scan for viruses.</p>

<p><b>fpscand</b> is the F-PROT Antivirus Daemon Scanner program. For general usage information and help, please read the 
section on <a href="http://www.f-prot.com/support/helpfiles/unix/fpscand.html">F-PROT Antivirus Daemon Scanner</a> in this helpfile as well as the 
man page <a href="http://www.f-prot.com/support/unix/unix_manpages/fpscand.8.html" target="_blank">(fpscand)</a>.</p>

<p>Note that although fpscand can scan MIME-encoded files, its MIME support is minimal and client 
applications should, if at all possible, decode e-mail attachments using robust MIME parsers before handing 
those attachments to fpscand for scanning. F-PROT Antivirus for Mail Servers uses a program
called <a href="http://www.f-prot.com/support/unix/unix_manpages/scan-mail.pl.8.html" target="_blank">scan-mail.pl</a> for 
this purpose.</p>

<p><b>How it works</b></p>

<p>By default, fpscand listens on port 10200 on the loopback address,
127.0.0.1. This can be changed either via the -a or --address startup
arguments to fpscand, or by setting a different address:port in the
FPSCAND_LISTENADDRESS variable in the config file /etc/f-prot.conf.</p>

<p><b>Communicating with the F-PROT Antivirus Daemon Scanner (fpscand)</b></p>

<p>fpscand uses a special syntax. First you establish a connection to the port and then the scan requests follow.</p>

<pre class="code_courier">telnet localhost 10200
SCAN FILE /path/to/file
SCAN STREAM streamname SIZE &lt;n&gt;
.. a stream of n bytes ..
</pre>

<p>Please note that the SIZE &lt;n&gt; must be followed by a newline symbol before the stream is fed in.</p>

<p>Then, fpscand sends a result string back to the port, where the
client can read it back and parse. The result string is of the form:</p>

n &lt;descriptive text&gt; &lt;name of the scanned object&gt;

<p>Where n is the <a href="http://www.f-prot.com/support/helpfiles/unix/appendix_c.html">result code</a>.</p>

<p>Example:</p>
<pre class="code_courier">telnet localhost 10200
SCAN FILE /home/user/somefile.zip
.. result string sent back ..
SCAN FILE /home/user/otherfile.zip
.. result string sent back ..
</pre>

<p>It is also possible to set up a queue of scans. This is done by entering the QUEUE command, followed by
a series of queue requests. The queue is then processed when an empty SCAN command is given.</p>

<p>Example:</p>
<pre class="code_courier">telnet localhost 10200
QUEUE
SCAN FILE /home/user/somefile.zip
SCAN FILE /home/user/otherfile.zip
SCAN
.. result string for /home/user/somefile.zip sent back ..
.. result string for /home/user/otherfile.zip sent back ..
</pre>

<p>Although fpscand will currently return the results for files in the
same order it received them, this is not guaranteed to hold in the
future.</p>


<p><b>Note:</b> FRISK Software offers a virus scan library and software development kits to licensed 3rd party 
software developers that need virus scanning capabilities.</p>

<p align="right"><a href="http://www.f-prot.com/support/helpfiles/unix/index.html">Back to Index</a></p>

</div>
<div class="underline">&nbsp;</div>
<div id="copyright">Copyright © 2007 FRISK Software International. All rights reserved</div>

</div>
        <div class="yui-gd yui-u sidebarthing" id="sidebarthing">
			<div class="yui-u first">
        &nbsp;
			</div>
<!-- Support sidebar unit -->
			<div class="yui-u sidebarthing">	

<table cellpadding="3" cellspacing="0" width="100%">
	<tbody><tr>
		<td class="left_links">Frequently Asked Questions by platform</td>
	</tr>
	<tr>
		<td class="left_content">
			<table width="100%">
				<tbody><tr>
					<td class="left_content">F-PROT Antivirus<br>
					- <a href="http://www.f-prot.com/support/windows/fpwin_faq/index.html">for Windows</a><br>
					- <a href="http://www.f-prot.com/support/unix/unix_faq/index.html">for UNIX</a><br>
					- <a href="http://www.f-prot.com/support/exchange/faq/index.html">for Exchange</a></td>
				</tr>
				<tr>
					<td class="left_content"><a href="http://www.f-prot.com/support/aves/faq/index.html">F-PROT AVES</a></td>
				</tr>
			</tbody></table>
		</td>
	</tr><tr>
	</tr><tr>
		<td class="left_links">Helpfiles</td>
	</tr>
	<tr>
		<td class="left_content">
			<table width="100%">
				<tbody><tr>
					<td class="left_content">F-PROT Antivirus<br>
					- <a href="http://www.f-prot.com/support/chm_helpfile_download_instructions_win.html">for Windows</a><br>
					- <a href="http://www.f-prot.com/support/helpfiles/unix/v6_index.html">for UNIX</a><br>
					- <a href="http://www.f-prot.com/support/chm_helpfile_download_instructions_exch.html">for Exchange</a></td>
				</tr>
				<tr>
					<td class="left_content"><a href="http://www.f-prot.com/support/aves/tutorial/index.html">F-PROT AVES</a></td>
				</tr>
			</tbody></table>
		</td>
	</tr><tr>
</tr></tbody></table>
<table cellpadding="3" cellspacing="0" width="100%">
	<tbody><tr>
		<td class="left_links">
			<a href="http://alerts.f-prot.com/cgi-bin/mf?lang=en" class="">
		F-PROT Antivirus Alerts
			</a>
		</td>
	</tr>
	<tr>
		<td>
	   		  <table border="0" cellpadding="0" cellspacing="0">
				<tbody><tr>
					<td class="left_content">	Stay up to date with important developments via e-mail.
					</td>
				</tr>
				<tr>
					<td class="out_links"><a href="http://alerts.f-prot.com/cgi-bin/mf?lang=en">more...</a></td>
				</tr>
			</tbody></table>
		</td>
	</tr>
        <tr>
		<td class="left_links">Life cyle policy</td>
	</tr>

	<tr>
		<td class="left_content">
			<table width="100%">
				<tbody><tr>
					<td class="left_content">Stay up to date with life cycle policies for F-PROT Antivirus for Windows. 
			       </td></tr>
                               <tr>
					<td class="out_links"><a href="http://www.f-prot.com/products/lifecycle_win.html">more...</a></td>
				</tr>

			</tbody></table>
		</td>
	</tr><tr>

</tr></tbody></table>


<table cellpadding="3" cellspacing="0" width="100%">
	<tbody><tr>
		<td class="left_links">
			<a href="http://www.f-prot.com/glossary/index.html" class="">
		Glossary of Terms
			</a>
		</td>
	</tr>
	<tr>
		<td>
	   		  <table border="0" cellpadding="0" cellspacing="0">
				<tbody><tr>
					<td class="left_content">	Definitions of common antivirus terminology.
					</td>
				</tr>
				<tr>
					<td class="out_links"><a href="http://www.f-prot.com/glossary/index.html">more...</a></td>
				</tr>
			</tbody></table>
		</td>
	</tr>
</tbody></table>

<br>

        <br>
			</div>
		</div>
        
			</div>
		</div>
		
		
		</div>
		

	


	<div id="ft">

						<p id="footerlinks">
            <a class="nav" href="http://www.f-prot.com/legal_notices.html">Legal notices</a> | 
            <a class="nav" href="http://www.f-prot.com/privacy.html">Privacy policy</a> |
            <a class="nav" href="http://frisk.is/">Icelandic</a> |
						<span class="copnav">&nbsp;&nbsp;FRISK Software International © 1993-2007. All rights reserved.</span>
            </p>

	</div>
</div>
</body></html>